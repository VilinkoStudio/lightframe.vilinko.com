import{l as u}from"./q-BVGk4Zpa.js";const S=({cleanup:E})=>{const R=u[0],v=u[1],l=u[2],h=u[3],c=u[4],f=()=>{const o=v.value;if(!o)return;const e=o.getContext("2d");if(!e)return;const n=o.width/devicePixelRatio,s=o.height/devicePixelRatio;e.clearRect(0,0,n,s);const t=c.value,r=window.matchMedia("(prefers-color-scheme: dark)").matches;e.save(),e.shadowColor=r?"rgba(0, 0, 0, 0.3)":"rgba(0, 0, 0, 0.1)",e.shadowBlur=30,e.shadowOffsetY=10,e.beginPath(),e.rect(t.l,t.t,t.r-t.l,t.b-t.t),e.fillStyle=r?"#262626":"#ffffff",e.fill(),e.shadowBlur=0,e.strokeStyle=r?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.05)",e.lineWidth=1,e.stroke(),e.restore(),e.fillStyle="#6366f1",[{x:t.l,y:t.t,id:"rect-tl"},{x:t.l,y:t.b,id:"rect-bl"},{x:t.r,y:t.b,id:"rect-br"}].forEach(i=>{e.beginPath(),e.arc(i.x,i.y,l.value===i.id?7:4,0,Math.PI*2),e.fill(),e.strokeStyle="white",e.stroke()});const a=h.value;a.length>0&&(e.beginPath(),a.forEach((i,d)=>d===0?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y)),e.closePath(),e.fillStyle=r?"rgba(42, 42, 42, 0.6)":"rgba(220, 220, 220, 0.4)",e.fill(),e.strokeStyle=r?"#9ca3af":"#6b7280",e.lineWidth=2,e.stroke(),e.fillStyle="#818cf8",a.forEach((i,d)=>{e.beginPath(),e.arc(i.x,i.y,l.value===d?8:5,0,Math.PI*2),e.fill()}))},k=(o,e,n,s)=>{const t=[],a=Math.PI*2/16;for(let i=0;i<16;i++){const d=i%2===0,L=d?.85+Math.random()*.3:.75+Math.random()*.3,P=(d?n:s)*L,M=i*a-Math.PI/2+(Math.random()-.5)*a*.15;t.push({x:o+Math.cos(M)*P,y:e+Math.sin(M)*P})}return t},g=()=>{const o=v.value;if(!o)return;const e=R.starCardRef.value;if(!e)return;const n=o.getContext("2d");if(!n)return;const s=o.getBoundingClientRect(),t=e.getBoundingClientRect(),r=window.devicePixelRatio||1;o.width=s.width*r,o.height=s.height*r,n.scale(r,r);const a=t.left-s.left,i=t.top-s.top;c.value.l===0&&(c.value={l:a,t:i,r:a+t.width,b:i+t.height}),h.value.length===0&&(h.value=k(a+t.width*.85,i+t.height*.22,Math.min(t.width,t.height)*.34,Math.min(t.width,t.height)*.24)),f()},y=o=>{const e=v.value;if(!e)return{x:0,y:0};const n=e.getBoundingClientRect();return{x:o.clientX-n.left,y:o.clientY-n.top}},w=o=>{const e=y(o),n=c.value,s=[{x:n.l,y:n.t,id:"rect-tl"},{x:n.l,y:n.b,id:"rect-bl"},{x:n.r,y:n.b,id:"rect-br"}];for(const r of s)if(Math.sqrt((e.x-r.x)**2+(e.y-r.y)**2)<25){l.value=r.id,o.preventDefault(),o.stopPropagation();return}const t=h.value;for(let r=0;r<t.length;r++)if(Math.sqrt((e.x-t[r].x)**2+(e.y-t[r].y)**2)<25){l.value=r,o.preventDefault(),o.stopPropagation();return}},m=o=>{const e=y(o),n={...c.value},s=h.value;let t=!1;[{x:n.l,y:n.t},{x:n.l,y:n.b},{x:n.r,y:n.b}].some(a=>Math.sqrt((e.x-a.x)**2+(e.y-a.y)**2)<25)&&(t=!0),s.some(a=>Math.sqrt((e.x-a.x)**2+(e.y-a.y)**2)<25)&&(t=!0),document.documentElement.style.cursor=l.value!==null?"grabbing":t?"grab":"",l.value!==null&&(typeof l.value=="string"?(l.value==="rect-tl"?n.l=e.x:l.value==="rect-bl"?(n.l=e.x,n.b=e.y):l.value==="rect-br"&&(n.b=e.y),c.value=n):s[l.value]={x:e.x,y:e.y},f())},x=()=>{l.value!==null&&(l.value=null,document.documentElement.style.cursor="",f())},p=window.matchMedia("(prefers-color-scheme: dark)"),b=()=>f();p.addEventListener("change",b),window.addEventListener("pointerdown",w,!0),window.addEventListener("pointermove",m),window.addEventListener("pointerup",x),window.addEventListener("resize",g),g(),E(()=>{p.removeEventListener("change",b),window.removeEventListener("pointerdown",w,!0),window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",x),window.removeEventListener("resize",g),document.documentElement.style.cursor=""})};export{S as s_KtvkZgVTcnU};

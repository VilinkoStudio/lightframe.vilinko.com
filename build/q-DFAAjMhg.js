const S=(q,a)=>{if(!window._qRouterSPA&&!window._qRouterInitPopstate){const u=location.pathname+location.search,d=o=>{o&&window.scrollTo(o.x,o.y)},c=()=>{const o=document.documentElement;return{x:o.scrollLeft,y:o.scrollTop,w:Math.max(o.scrollWidth,o.clientWidth),h:Math.max(o.scrollHeight,o.clientHeight)}},l=o=>{const n=history.state||{};n._qRouterScroll=o||c(),history.replaceState(n,"")};if(l(),window._qRouterInitPopstate=()=>{if(!window._qRouterSPA){if(window._qRouterScrollEnabled=!1,clearTimeout(window._qRouterScrollDebounce),u!==location.pathname+location.search){const r=(i=>i.closest("[q\\:container]:not([q\\:container=html]):not([q\\:container=text])"))(a).qContainer,t=r.vNodeLocate(a),e=r?.resolveContext(t,{id:"qc--n"});e?e(location.href,{type:"popstate"}):location.reload()}else if(history.scrollRestoration==="manual"){const o=history.state?._qRouterScroll;d(o),window._qRouterScrollEnabled=!0}}},!window._qRouterHistoryPatch){window._qRouterHistoryPatch=!0;const o=history.pushState,n=history.replaceState,r=t=>(t===null||typeof t>"u"?t={}:t?.constructor!==Object&&(t={_data:t}),t._qRouterScroll=t._qRouterScroll||c(),t);history.pushState=(t,e,i)=>(t=r(t),o.call(history,t,e,i)),history.replaceState=(t,e,i)=>(t=r(t),n.call(history,t,e,i))}window._qRouterInitAnchors=o=>{if(window._qRouterSPA||o.defaultPrevented)return;const n=o.target.closest("a[href]");if(n&&!n.hasAttribute("preventdefault:click")){const r=n.getAttribute("href"),t=new URL(location.href),e=new URL(r,t),i=e.origin===t.origin,w=e.pathname+e.search===t.pathname+t.search;if(i&&w)if(o.preventDefault(),e.href!==t.href&&history.pushState(null,"",e),!e.hash)e.href.endsWith("#")?window.scrollTo(0,0):(window._qRouterScrollEnabled=!1,clearTimeout(window._qRouterScrollDebounce),l({...c(),x:0,y:0}),location.reload());else{const h=e.hash.slice(1),s=document.getElementById(h);s&&s.scrollIntoView()}}},window._qRouterInitVisibility=()=>{!window._qRouterSPA&&window._qRouterScrollEnabled&&document.visibilityState==="hidden"&&l()},window._qRouterInitScroll=()=>{window._qRouterSPA||!window._qRouterScrollEnabled||(clearTimeout(window._qRouterScrollDebounce),window._qRouterScrollDebounce=setTimeout(()=>{l(),window._qRouterScrollDebounce=void 0},200))},window._qRouterScrollEnabled=!0,setTimeout(()=>{window.addEventListener("popstate",window._qRouterInitPopstate),window.addEventListener("scroll",window._qRouterInitScroll,{passive:!0}),document.addEventListener("click",window._qRouterInitAnchors),window.navigation||document.addEventListener("visibilitychange",window._qRouterInitVisibility,{passive:!0})},0)}};export{S as s_3l2mAo0nHiY};
